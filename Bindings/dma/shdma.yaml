# SPDX-License-Identifier: None
%YAML 1.2
---
$id: http://devicetree.org/schemas/Bindings/dma/shdma.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#
version: 1

title: SHDMA Device Tree bindings

maintainers:
  - Guennadi Liakhovetski <g.liakhovetski@gmx.de>
description: |+
  Sh-/r-mobile and R-Car systems often have multiple identical DMA controller
  instances, capable of serving any of a common set of DMA slave devices, using
  the same configuration. To describe this topology we require all compatible
  SHDMA DT nodes to be placed under a DMA multiplexer node. All such compatible
  DMAC instances have the same number of channels and use the same DMA
  descriptors. Therefore respective DMA DT bindings can also all be placed in the
  multiplexer node. Even if there is only one such DMAC instance on a system, it
  still has to be placed under such a multiplexer node.

  * DMA multiplexer

             

properties:
  compatible:
    items:
      - enum:
          - renesas,shdma-r8a73a4
          - renesas,shdma-mux
    minItems: 1
    maxItems: 1
    additionalItems: false
  '#dma-cells':
    const: 0x1
  dma-channels: {}
  dma-requests: {}
  '#address-cells':
    const: 0x2
  '#size-cells':
    const: 0x2
  ranges: {}
  reg:
    minItems: 1
    maxItems: 1
    additionalItems: false
  interrupts: {}
  interrupt-names:
    items:
      - const: error
      - const: ch0
      - const: ch1
      - const: ch2
      - const: ch3
      - const: ch4
      - const: ch5
      - const: ch6
      - const: ch7
      - const: ch8
      - const: ch9
      - const: ch10
      - const: ch11
      - const: ch12
      - const: ch13
      - const: ch14
      - const: ch15
      - const: ch16
      - const: ch17
      - const: ch18
      - const: ch19
    minItems: 21
    maxItems: 21
    additionalItems: false
  clocks: {}
  power-domains: {}
examples:
  - |
    dmac: dma-multiplexer@0 {
      compatible = "renesas,shdma-mux";
      #dma-cells = <1>;
      dma-channels = <20>;
      dma-requests = <256>;
      #address-cells = <2>;
      #size-cells = <2>;
      ranges;

      dma0: dma-controller@e6700020 {
        compatible = "renesas,shdma-r8a73a4";
        reg = <0 0xe6700020 0 0x89e0>;
        interrupt-parent = <&gic>;
        interrupts = <0 220 4
            0 200 4
            0 201 4
            0 202 4
            0 203 4
            0 204 4
            0 205 4
            0 206 4
            0 207 4
            0 208 4
            0 209 4
            0 210 4
            0 211 4
            0 212 4
            0 213 4
            0 214 4
            0 215 4
            0 216 4
            0 217 4
            0 218 4
            0 219 4>;
        interrupt-names = "error",
            "ch0", "ch1", "ch2", "ch3",
            "ch4", "ch5", "ch6", "ch7",
            "ch8", "ch9", "ch10", "ch11",
            "ch12", "ch13", "ch14", "ch15",
            "ch16", "ch17", "ch18", "ch19";
      };
    };
historical: |+
  * SHDMA Device Tree bindings

  Sh-/r-mobile and R-Car systems often have multiple identical DMA controller
  instances, capable of serving any of a common set of DMA slave devices, using
  the same configuration. To describe this topology we require all compatible
  SHDMA DT nodes to be placed under a DMA multiplexer node. All such compatible
  DMAC instances have the same number of channels and use the same DMA
  descriptors. Therefore respective DMA DT bindings can also all be placed in the
  multiplexer node. Even if there is only one such DMAC instance on a system, it
  still has to be placed under such a multiplexer node.

  * DMA multiplexer

  Required properties:
  - compatible:	should be "renesas,shdma-mux"
  - #dma-cells:	should be <1>, see "dmas" property below

  Optional properties (currently unused):
  - dma-channels:	number of DMA channels
  - dma-requests:	number of DMA request signals

  * DMA controller

  Required properties:
  - compatible:	should be of the form "renesas,shdma-<soc>", where <soc> should
  		be replaced with the desired SoC model, e.g.
  		"renesas,shdma-r8a73a4" for the system DMAC on r8a73a4 SoC

...
